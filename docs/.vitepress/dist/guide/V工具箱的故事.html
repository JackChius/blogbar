<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从一段脚本到工具箱 | Dunye blog</title>
    <meta name="description" content="A blog site with dunye">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.DHnYi_2k.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DJiJL6lt.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.D2cWRMha.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BISkuWHZ.js">
    <link rel="modulepreload" href="/assets/guide_V工具箱的故事.md.DN0rR4bT.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/avatar.png" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>Dunye blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>记录</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>项目</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/dunye" aria-label="gitee" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-gitee"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/dunye" aria-label="gitee" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-gitee"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b7550ba0><!----><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/Tomatoo-一款轻量云笔记诞生录.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Tomatoo-一款轻量云笔记诞生录</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/Vue2中Push对象-数组遇到的问题.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Vue2中Push对象-数组遇到的问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/Vue2建站踩坑系列之作用域.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Vue2建站踩坑系列之作用域</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/V工具箱的故事.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>V工具箱的故事</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/WSL2-日常开发不完全指北.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>WSL2-日常开发不完全指北</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/一次吸顶效果的探索.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>一次吸顶效果的探索</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/一次探索追踪疫情数据的旅程-每日邮件.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>一次探索追踪疫情数据的旅程-每日邮件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/关于Vue与angular的一些看法.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>关于Vue与angular的一些看法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/拨开云雾-基于ES-Kibana进一步数据可视化分析某科技社区APP.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>拨开云雾-基于ES-Kibana进一步数据可视化分析某科技社区APP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/效率脚本-Curl2Py从6到3步的实验.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>效率脚本-Curl2Py从6到3步的实验</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/病毒扩散城市仿真模拟自制小游戏.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>病毒扩散城市仿真模拟自制小游戏</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/记一次数据采集分析某科技社区APP的过程.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>记一次数据采集分析某科技社区APP的过程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/记录一次Canvas绘图优化的过程.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>记录一次Canvas绘图优化的过程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/遇到微信小程序的一个痛点.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>遇到微信小程序的一个痛点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/guide/项目的变迁，一些变化的记录.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>项目的变迁，一些变化的记录</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _guide_V%E5%B7%A5%E5%85%B7%E7%AE%B1%E7%9A%84%E6%95%85%E4%BA%8B" data-v-39a288b8><div><h1 id="从一段脚本到工具箱" tabindex="-1">从一段脚本到工具箱 <a class="header-anchor" href="#从一段脚本到工具箱" aria-label="Permalink to &quot;从一段脚本到工具箱&quot;">​</a></h1><p>日常在网上不时能发现些能用在工作流中的好工具，这些工具往往能能极大提高到自己工作的效率，后面我想能不自己也来写一款，更加符合自己效率习惯的工具呢，于是也有了今天分享的这款工具，我个人开发自用的一款工具箱，也是我自身开发的一个完整的项目，说说其使用的方法和它背后的一些故事。</p><p><strong>先来看看这款的工具箱的全貌</strong></p><table tabindex="0"><thead><tr><th>形态一</th><th>形态二</th></tr></thead><tbody><tr><td><img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/eb89fed3d0f54ca8a821f5df82629743~tplv-k3u1fbpfcp-watermark.png" alt=""></td><td><img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/fcaacb26ef604ce0aa2d40db2dba67f0~tplv-k3u1fbpfcp-watermark.png" alt=""></td></tr></tbody></table><p><strong>如图所示</strong>，我将这款工具命名为<strong>V工具箱</strong>，大体分为两个区域，目前工具箱内集成了三个功能，包括</p><ul><li>变色台 简单快捷的图像分享处理， 使用场景:方便快捷处理图片发微信,不打开PS的情况下快速处理图片等等</li><li>配置变换 特定环境下，快速切换项目的开发环境。</li><li>泥石流 根据指定的标题和URL制作醒目的泥石流大字图。</li><li>检查更新 支持应用本身的远程热更新</li></ul><p>其中变色台和配置变换是已经完成并投入使用的功能，更新模块和另外的泥石流图文分享模块还在进一步完善当中。</p><h2 id="从一段脚本说起" tabindex="-1">从一段脚本说起 <a class="header-anchor" href="#从一段脚本说起" aria-label="Permalink to &quot;从一段脚本说起&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">V工具盒里的配置变换功能，作用在于能够在选定指定的配置文件后，快速批量替换文件里面的环境变量参数，达到快速切换项目环境的目的。</span></span></code></pre></div><p>说到这一功能的实现，还得从一段脚本说起，之前在工作项目开发的时候，笔者写了一些小段的脚本，包括处理一些项目里重复操作或者是简化发布部署流程的需求，其中项目的多环境部署，环境变量切换是一个经常遇到的需求，在经过一段时间的人工穿插多个文件修改的‘原始’方案后，我花了些时间，分析这个场景的共有逻辑，发现其可以抽取为一个公共的配置文件，而后我写了一段脚本，将这一过程变为了直观的命令点选方式，下面是脚本当时的样子 <img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/e14f64092e5947aaa6972db0db7199cb~tplv-k3u1fbpfcp-watermark.gif" alt=""> 除此之外，脚本还集成了一个项目多国语言字段的新增修改以及检查的功能，在当时来看同样是一个相对变更频繁的需求，我也顺道将它以集成到脚本当中。 <img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/72729181196840e9a65929d174dde2d4~tplv-k3u1fbpfcp-watermark.png" alt=""></p><p><strong><code>下面是脚本两段功能对应修改效果的示例（为方便演示，合成到了一个窗口中）</code></strong></p><p><img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/679c97ce081b42df89b441fb124f421f~tplv-k3u1fbpfcp-watermark.gif" alt="左边为环境切换对应配置，右边为多语系"> 当脚本执行后，上面对应配置文件的参数就会做出相应的变化，两段脚本的核心逻辑都是对特定配置文件的自动化操作，而在这个过程中，也大大提高了相应场景的工作效率。</p><p>支撑这两段脚本功能的实现，主要用到了Node.js本身的特性，以及对<strong>commander</strong>和<strong>inquirer</strong>这俩Node中处理命令行的包的组合运用，其中commander负责响应用户在命令行的<strong>输入参数</strong>，也就是node xbot 后面change或plus字段，而inquirer则接管了对命令行参数的<strong>交互形式</strong>，以及后续的处理逻辑，交互形式就是说待选参数以<strong>列表，多选框，单选框</strong>还是怎样的形式去表现，从而<strong>与用户交互，做出下一步的参数选择</strong>，在上面说到的两段脚本中，就分别用到了list和多次input输入这两种不同形态的交互方式，下面截取了一段相关的代码。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ----[命令事件]切换开发环境</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">commander</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;change&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;一键切换开发环境&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dir1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        inquirer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(changeEnvQues).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {					</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> quesIndex </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(configFilePath, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;utf8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">myData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">				// dothings......			</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* const changeEnvQues = [{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    type: &#39;list&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    message: &#39;要切换到的开发环境?&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    name: &#39;ENV&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    choices: [{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		value: &#39;0&#39; ,		</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		name:&quot;本地开发环境(192.168.1.1服务器)&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	}, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		value: &#39;1&#39; ,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		name: &quot;Test环境(XX地区服务器)&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	}, { value: &#39;2&#39;, name: &#39;其他环境&#39;}]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">}, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    type: &#39;confirm&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    message: &#39;确定要切换到这个环境？&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    name: &#39;isChange&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    default: true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">}] */</span></span></code></pre></div><p>可以看到commander能以链式调用的形式，去处理每一步的参数逻辑，而inquire的交互形式，具体选项等参数，可以装载在一个变量数组中，整个流程可以比较清晰的展开出来。</p><h2 id="从脚本到工具箱" tabindex="-1">从脚本到工具箱 <a class="header-anchor" href="#从脚本到工具箱" aria-label="Permalink to &quot;从脚本到工具箱&quot;">​</a></h2><p>脚本这块到这里说的差不多，在后面的日常开发过程中，这些脚本大都运行良好，单纯功能上没有太大的问题，与此同时笔者在一段时间内尝试用Electron以前端的技术栈去开发和迁移一些原有的项目，在将脚本与小伙伴们共享的时候，笔者发觉命令行对于一些不熟悉相关操作的人来说，还是显得晦涩了一些，如果能将部分脚本以界面UI的形式操作，可能也是一种很好的方式去使用，于是在经过一段时间的迁移开发后，也就有了V工具盒的第一个功能-<strong>配置变换</strong>。 <img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/fe06c0d205a44e2c9d9835c9c712381a~tplv-k3u1fbpfcp-watermark.png" alt=""> 可以看到，从脚本&#39;变身&#39;为工具盒的一部分后，保留了脚本原有的大部分功能，相对脚本也改进了几个方面：</p><ul><li>页面操作对于环境切换这一场景来说，似乎变得更方便了</li><li>配置文件可选，之前脚本的时候，配置文件路径必须在代码写好，不灵活</li><li>支持新增新的环境，相比之前脚本的环境列表这块也只能提前固定写好</li></ul><p>总的来说，在将脚本迁移到前端页面的形式过程中，能真实感受到<strong>两种技术，或者说交互形式的异同</strong>，<strong>对于两者来说没有绝对的谁更适合，只有在不同场景下，不同人群的使用中，对谁更友好的区别</strong>，如果说这两种交互形式，对于笔者自用哪种更好，笔者我可能还是会选脚本的形式，毕竟自用来说，命令行无论从开发效率还是使用效率来说，还是比界面操作更为方便，关于这点，<strong>有不同想法的小伙伴也可以在评论留言，如果有更好的实现方式，也欢迎小伙伴们一起分享分享。</strong></p><h2 id="关于变色台" tabindex="-1">关于变色台 <a class="header-anchor" href="#关于变色台" aria-label="Permalink to &quot;关于变色台&quot;">​</a></h2><p>终于来到了变色台这块，这功能原本笔者想命名为<strong>变色龙</strong>，但发现市面上变色龙这词用的人实在有点多，而且在一些领域也有部分贬义，所以后面就改为了<strong>变色台</strong>。变色台的灵感来源于在生活中需要分享图片的时候，受制于手机本身编辑图片的不方便，而一些小的需改打开PS往往又显得臃肿而麻烦了，在学习canvas相关知识的过程中，笔者想着不如试着做一款简便的图片微调工具，方便日常分享照片的同时也能一窥canvas在前端的绘图机制，也是个不错的方法，于是也便有了变色台的诞生。 <img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/231d1396fdaa43d785b7d1ef5743a002~tplv-k3u1fbpfcp-watermark.gif" alt=""> 可以看到，一些照片分享中常用的<strong>黑白，减曝光，复古</strong>等处理，能让图片呈现出不同的效果，合理地运用相信能在<strong>日常社交的图文分享</strong>中发挥出不少用处，这里主要运用了Canvas2D的绘图能力，也是笔者对Cnavas学习之后的一次实践，说到Canvas这块网上有不少案例可供参考，不过在实现的过程中，也遇到了不少困难。 <code>这里是变色台实现拖拽操作的过程</code><img src="https://7463-tcb-3hkf8tmwpkhh8ns-3c1ufa774006-1323121995.tcb.qcloud.la/blog/0d354852967e4637bc66edcd53da2a62~tplv-k3u1fbpfcp-watermark.gif" alt=""> 我们可以看到，这里实现了对上传图片的鼠标拖拽以及滑动缩放的操作，整个效果看起来还算流畅跟手，不然而在之前初期的开发过程中，图片的拖拽并没有像现在那样跟手，表现为鼠标推拽图片时总会慢一拍，而且在拖拽过程中鼠标准心并不会一直落在图片的正中心，整个画面能看出肉眼的卡顿感。</p><p><strong><code>解决方法</code></strong> 经过一段时间的研究摸索，发现影响拖拽效果的因素主要有两个，一个是<strong>画布图片坐标与窗口坐标的定位</strong>，另一个是如何精准<strong>获取鼠标实时的坐标，及相对于图片的位置</strong>，这里牵扯到坐标系统和图片位置的计算，在一般页面的坐标中，我们一般可以通过下面的方法获取:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // body展示的宽度，表示body在浏览器内显示的区域宽度。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.body.clientWidth</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // body展示的高度，表示body在浏览器内显示的区域高度。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.body.clientHeight</span></span></code></pre></div><p>可以看到通过鼠标事件获取的坐标，与窗口client坐标系统是对等的，这里不用作太多转换，由于项目同时需要缩放预览的功能，这也是一个需要解决的问题。我的做法是在页面坐标中先获取到鼠标的位置，然后根据鼠标位置与图片的宽高差值，再和图片当前的宽高作比例，这样能获得相对准确的鼠标移动后的定位，同时也能确定好图片拖拽后的新的落脚位置，从实际效果看，这个转换方法也许还不够严谨，但是拖拽体验比之前得到了提升，消除了卡顿现象，代码行数也能控制在客观的范围内。</p><p><code>下面贴上我在这个项目里相关方法的思路（此处为伪代码）</code></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  canImg.x  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//图片X坐标（窗口）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  canImg.y  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//图片Y坐标（窗口）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  canImg.w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> imgW </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//图片宽</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  canImg.h </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> imgH </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 图片高 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mouse.x </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//鼠标坐标X（移动前）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mouse.y </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 鼠标坐标Y（移动前）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  position.x </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 鼠标坐标X（移动后，当前实时）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  position.y </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 鼠标坐标Y（移动后，当前实时）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MouseRatioImageX </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (mouse.x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.w </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 计算X轴图片缩放比例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MouseRatioImageY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (mouse.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.y) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.h  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 计算Y轴图片缩放比例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newX </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position.x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MouseRatioImageX </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 图片Canvavs中新的绘制坐标X</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> position.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canImg.h </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MouseRatioImageY </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 图片Canvavs中新的绘制坐标Y</span></span></code></pre></div><p>另外前段时间，也记录了另外一个关于变色台的优化过程，详见 <a href="https://juejin.im/post/6885263846811172877" target="_blank" rel="noreferrer">记录一次Canvas绘图优化的过程</a></p><h2 id="todo-后记" tabindex="-1">Todo &amp; 后记 <a class="header-anchor" href="#todo-后记" aria-label="Permalink to &quot;Todo &amp; 后记&quot;">​</a></h2><p>写到这里，不知道大家对这款工具盒有些什么看法，关于V工具盒的点点滴滴，还有不少可以分享的地方，后续也会抽时间在这篇文章补充更多的使用或是开发心得，这里先放上工具盒的下载地址，下载安装后即可体验。</p><p><a href="https://wws.lanzous.com/ieCUNifsb0h" target="_blank" rel="noreferrer"><strong>V工具盒云盘地址</strong></a></p><p>另外，本文也同步发表到了掘金平台。 阅读链接： <a href="https://juejin.cn/post/6886072157324083208" target="_blank" rel="noreferrer">https://juejin.cn/post/6886072157324083208</a></p><p>关于以后的计划，笔者打算在遇到合适的灵感/功能需求，或是学习了新的知识后，适时给工具盒添加更多的功能，让它变得更像一个多功能的趁手的工具盒~</p><p>也希望各位点进来的小伙伴们，可以分享自己的想法，如果能在我的心得分享中找到共鸣有所收获，那这篇文章也是有意义的😋</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/guide/Vue2建站踩坑系列之作用域.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Vue2建站踩坑系列之作用域</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/guide/WSL2-日常开发不完全指北.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>WSL2-日常开发不完全指北</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"B12n9SLI\",\"guide_index.md\":\"C6CEd5aw\",\"guide_tomatoo-一款轻量云笔记诞生录.md\":\"C6mW9Y9A\",\"guide_vue2中push对象-数组遇到的问题.md\":\"DaS5UHLt\",\"guide_vue2建站踩坑系列之作用域.md\":\"1TTe8zZR\",\"guide_v工具箱的故事.md\":\"DN0rR4bT\",\"guide_wsl2-日常开发不完全指北.md\":\"CSt7dzxb\",\"guide_一次吸顶效果的探索.md\":\"BVf6ZTNr\",\"guide_一次探索追踪疫情数据的旅程-每日邮件.md\":\"DUA3dBg1\",\"guide_关于vue与angular的一些看法.md\":\"CRiGHx5Y\",\"guide_拨开云雾-基于es-kibana进一步数据可视化分析某科技社区app.md\":\"shhgruYX\",\"guide_效率脚本-curl2py从6到3步的实验.md\":\"_qEgLMRw\",\"guide_病毒扩散城市仿真模拟自制小游戏.md\":\"BkhYnfg6\",\"guide_记一次数据采集分析某科技社区app的过程.md\":\"BF0w1T9S\",\"guide_记录一次canvas绘图优化的过程.md\":\"Mck4jOsc\",\"guide_遇到微信小程序的一个痛点.md\":\"CTWy-v2r\",\"guide_项目的变迁，一些变化的记录.md\":\"ic_27vSN\",\"index.md\":\"DL5Omgr3\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Dunye blog\",\"description\":\"A blog site with dunye\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/avatar.png\",\"nav\":[{\"text\":\"记录\",\"link\":\"/\"},{\"text\":\"项目\",\"link\":\"/guide/\"}],\"socialLinks\":[{\"icon\":\"gitee\",\"link\":\"https://gitee.com/dunye\"}],\"search\":{\"provider\":\"local\"},\"sidebar\":{\"/\":[{\"items\":[{\"text\":\"api-examples\",\"link\":\"/api-examples.html\"}]}],\"/guide/\":[{\"items\":[{\"text\":\"Tomatoo-一款轻量云笔记诞生录\",\"link\":\"/guide/Tomatoo-一款轻量云笔记诞生录.html\"},{\"text\":\"Vue2中Push对象-数组遇到的问题\",\"link\":\"/guide/Vue2中Push对象-数组遇到的问题.html\"},{\"text\":\"Vue2建站踩坑系列之作用域\",\"link\":\"/guide/Vue2建站踩坑系列之作用域.html\"},{\"text\":\"V工具箱的故事\",\"link\":\"/guide/V工具箱的故事.html\"},{\"text\":\"WSL2-日常开发不完全指北\",\"link\":\"/guide/WSL2-日常开发不完全指北.html\"},{\"text\":\"一次吸顶效果的探索\",\"link\":\"/guide/一次吸顶效果的探索.html\"},{\"text\":\"一次探索追踪疫情数据的旅程-每日邮件\",\"link\":\"/guide/一次探索追踪疫情数据的旅程-每日邮件.html\"},{\"text\":\"关于Vue与angular的一些看法\",\"link\":\"/guide/关于Vue与angular的一些看法.html\"},{\"text\":\"拨开云雾-基于ES-Kibana进一步数据可视化分析某科技社区APP\",\"link\":\"/guide/拨开云雾-基于ES-Kibana进一步数据可视化分析某科技社区APP.html\"},{\"text\":\"效率脚本-Curl2Py从6到3步的实验\",\"link\":\"/guide/效率脚本-Curl2Py从6到3步的实验.html\"},{\"text\":\"病毒扩散城市仿真模拟自制小游戏\",\"link\":\"/guide/病毒扩散城市仿真模拟自制小游戏.html\"},{\"text\":\"记一次数据采集分析某科技社区APP的过程\",\"link\":\"/guide/记一次数据采集分析某科技社区APP的过程.html\"},{\"text\":\"记录一次Canvas绘图优化的过程\",\"link\":\"/guide/记录一次Canvas绘图优化的过程.html\"},{\"text\":\"遇到微信小程序的一个痛点\",\"link\":\"/guide/遇到微信小程序的一个痛点.html\"},{\"text\":\"项目的变迁，一些变化的记录\",\"link\":\"/guide/项目的变迁，一些变化的记录.html\"}]}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>